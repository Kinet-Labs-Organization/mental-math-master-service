generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Authentication and authorization related enums
enum SignUpMethod {
  EMAIL
  GOOGLE
  GMAIL
  FACEBOOK
  APPLE
}

enum Role {
  SYSTEM
  ADMIN
  NORMAL
}

enum SubscriptionStatus {
  SUBSCRIBED
  UNSUBSCRIBED
  TRIAL
}

// User model
model User {
  id                     Int            @id @default(autoincrement())
  email                  String         @unique
  password               String?
  name                   String?
  subscribedOn           DateTime?
  subscriptionExpiration DateTime?
  term                   String?
  status                 String
  report                 Report?
  gameActivities         GameActivity[]
  SignUpMethod           SignUpMethod   @default(GMAIL)
  createdAt              DateTime       @default(now())
  updatedAt              DateTime       @updatedAt
}

// Report model: one-to-one with User
model Report {
  id          Int   @id @default(autoincrement())
  gamesPlayed Int   @default(0)
  accuracy    Float @default(0)
  streak      Int   @default(0)
  score       Int   @default(0)

  user   User @relation(fields: [userId], references: [id])
  userId Int  @unique

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// GameActivity model: one-to-many with User
model GameActivity {
  id             Int      @id @default(autoincrement())
  gameId         String
  gameType       String
  correctAnswers Int
  wrongAnswers   Int
  playedAt       DateTime

  user   User @relation(fields: [userId], references: [id])
  userId Int

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
